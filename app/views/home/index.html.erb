<%-# Adding js and css needed declaration to header -%>
<% content_for :head_css_includes do %>
<%= stylesheet_link_tag "home", media: "all", "data-turbolinks-track" => true %>
<% end %>

<% content_for :head_js_includes do %>
<META HTTP-EQUIV="Refresh" CONTENT="120;"> 
<% end %>

<% content_for :head_title do %>
Home
<% end %>

<section class="row">
  <div class="sec_header col-md-12">
    <h2>Acceuil</h2>
  </div>

  <%= render 'layouts/flash' %>
  <div class="sec_content col-md-12">
    <div class="row">
      <div class="col-md-12">
        <% if !@unavailable_sensors.empty? %>
          <div class="alert alert-warning">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
            <span class="glyphicon glyphicon-warning-sign form-control-feedback"></span>
            <strong>Warning! Certains capteur sont inactifs: </strong>
            <ul>
              <% @unavailable_sensors.each do |sensor| %>
              <li>
            <td><%= sensor.room.name %>: </td>
            <td> <%= sensor.name %> </td>
              </li>
              <% end %>
            </ul>
            Pensez à vérifier les piles des capteurs concernés par cette alerte
          </div>
          <% end %>
      </div>
      
      <div class="col-md-12">
        <% if !@unavailable_sensors.empty? %>
	<div class="alert alert-info">
	  <center><strong>Nouveaux Capteurs détéctés<br></strong></center>
	  <a href="/sensors/list">
	    <button type="button" class="btn btn-info">Ajouter un capteur</button>
	  </a>
	  <br>
	  <% end %>
	</div>
      </div>
      

      <!-- <button type="button" class="btn btn-info" data-container="body" data-toggle="popover" data-placement="bottom"  -->
      <!-- 		data-content="<% @new_sensors.each do |sensor| %> -->
      <!-- 			      <li> -->
      <!-- 				<td><%= sensor.id %> </td> -->
      <!-- 			      </li> -->
      <!-- 			      <% end %>"> -->
      <!-- 	Nouveaux Capteurs détéctés</button> -->
      
      

      <% @stats.each_slice(3) do |s_daily_stats| %>
      <div class="row">
	<% s_daily_stats.each do |daily_stats| %>
	<div class="col-md-4">
	  <center><h1><%= daily_stats.typename %></h1></center>
	  <input type='text' name='compteur' value='<%= daily_stats.curin %>' class='compteur' data-type='<%= daily_stats.typename %>' data-min='<%= daily_stats.min %>' data-max='<%= daily_stats.max %>' 
		 data-avg='<%= daily_stats.avg %>' data-curin='<%= daily_stats.curin %>' data-curout='<%= daily_stats.curout %>' data-color='#33cc00' data-taille='125' />
	  
	</div>
	<% end %>
	<% end %>
      </div>
      <div class="row">
	<div class="col-md-12">
	  <canvas id="legende"></canvas>
	</div>
      </div>
      <%= javascript_include_tag "home", "data-turbolinks-track" => true %>
    </div>
  </div>    

</section>
